{
    "contents" : "library(shiny)\nlibrary(ngramr)\nlibrary(xtable)\n\n# Define server logic required to generate and trend data from google trends\nshinyServer(function(input, output) {\n  ##Gets data from Google\n  data <- reactive({ngram(as.character(input$term),corpus=\"eng_2012\",year_end=2012,smoothing=0)})\n  \n  ##Takes inputs from the date range input.\n  year_start <- reactive({input$start})\n  year_end <- reactive({input$end})\n  \n  ##Takes input from the subsampling control.\n  sub_factor <- reactive({input$sub})\n  \n  output$ols_timePlot <- renderPlot({\n    ##Subsets the data.\n    data2 <- data()[data()$Year>=year_start() & data()$Year<=year_end(),]\n    \n    ##Plots the data.\n    plot(data2$Year,data2$Frequency,type='l',col=\"slateblue\",xlab=\"Year\",ylab=\"Ngram Frequency\",main=\"Trend over Time\")\n    points(data2$Year,data2$Frequency,pch=21,bg=\"white\")\n    \n    ##Adds a trend line to the plot.\n    model <- lm(data2$Frequency~data2$Year)\n    if(input$trend==T){\n      abline(model,lty=2)\n     }\n  })\n  \n  output$ols_diagPlot <- renderPlot({\n    if(input$diag==T){\n      data2 <- data()[data()$Year>=year_start() & data()$Year<=year_end(),]\n      model <- lm(data2$Frequency~data2$Year)\n      resid <- residuals(model,type=\"response\")\n      acf <- acf(resid)\n      par(mfrow=c(1,2))\n      plot(data2$Year,resid,type=\"p\",main=\"Residuals\",ylab=\"Residuals\",xlab=\"Year\")\n      abline(h=0)\n      plot(acf,main=\"Auto-correlation Function\",xlab=\"Lag (Years)\")\n    }\n    \n  output$ols_modTable <- renderTable({\n    if(input$mod==T){\n      data2 <- data()[data()$Year>=year_start() & data()$Year<=year_end(),]\n      model <- lm(data2$Frequency~data2$Year)\n      coefs <- summary(model)$coefficients\n      rownames(coefs) <- c(\"Int.\",\"Year\")\n      return(coefs)\n    }\n  },digits=-2)\n    \n    output$sub_timePlot <- renderPlot({\n      ##Subsets the data.\n      data2 <- data()[data()$Year>=year_start() & data()$Year<=year_end(),]\n      \n      ##Plots the data.\n      plot(data2$Year,data2$Frequency,type='l',col=\"slateblue\",xlab=\"Year\",ylab=\"Ngram Frequency\",main=\"Trend over Time\")\n      \n      ##Subsets the data.\n      data3 <- data2[c(rep(FALSE,sub_factor()),TRUE),]\n      points(data3$Year,data3$Frequency,pch=21,bg=\"white\")\n      \n      ##Adds a trend line to the plot.\n      model <- lm(data3$Frequency~data3$Year)\n      if(input$trend==T){\n        abline(model,lty=2)\n      }\n    })\n    \n    output$sub_diagPlot <- renderPlot({\n      if(input$diag==T){\n        data2 <- data()[data()$Year>=year_start() & data()$Year<=year_end(),]\n        ##Subsets the data.\n        data3 <- data2[c(rep(FALSE,sub_factor()),TRUE),]\n        \n        model <- lm(data3$Frequency~data3$Year)\n        resid <- residuals(model,type=\"response\")\n        acf <- acf(resid)\n        par(mfrow=c(1,2))\n        plot(data3$Year,resid,type=\"p\",main=\"Residuals\",ylab=\"Residuals\",xlab=\"Year\")\n        abline(h=0)\n        plot(acf,main=\"Auto-correlation Function\",xlab=\"Lag (Years)\")\n      }\n    })\n      \n      output$sub_modTable <- renderTable({\n        if(input$mod==T){\n          data2 <- data()[data()$Year>=year_start() & data()$Year<=year_end(),]\n          data3 <- data2[c(rep(FALSE,sub_factor()),TRUE),]\n          model <- lm(data3$Frequency~data3$Year)\n          coefs <- summary(model)$coefficients\n          rownames(coefs) <- c(\"Int.\",\"Year\")\n          return(coefs)\n        }\n      },digits=-2)\n      \n  })\n})",
    "created" : 1386716052964.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4292108528",
    "id" : "F13A951A",
    "lastKnownWriteTime" : 1386699958,
    "path" : "~/code/delta_c/mod1_regression/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}