{
    "contents" : "\n# This is the server logic for a Shiny web application.\n# You can find out more about building applications with Shiny here:\n# \n# http://www.rstudio.com/shiny/\n#\n\nlibrary(shiny)\n\n##Generates two time-series: one with memory, one without.\nset.seed(42)\nint <- 0.5\nslope <- 0.03\nn <- 150\nmem_sim <- int+slope*seq(1:n)+arima.sim(n = n, \n                    model=list(ar = c(1, -0.2), ma = c(-0.2279, 0.2488)),\n                    rand.gen = function(n, ...) sqrt(0.1796) * rt(n, df = 5))\nnomem_sim <- int+slope*seq(1:n)+arima.sim(n=n,model=list())\n\n##Function to subset the data,fits a regression to the data, and plot it.\n\nplotfun <- function(series,window,center){ \n  ##subsets and computes the regression.\n  start <- center-window\n  end <- center+window\n  sub <- series[start:end]\n  sub_lm <- lm(sub~c(start:end))\n  ##creates the plot\n  ymin <- min(sub) - 20\n  ymax <- max(sub) + 20\n  ts.plot(series,col=rgb(0.3,0.3,0.8,1),lwd=1.5)\n  polygon(x=c(start,end,rev(c(start,end))),\n          y=c(rep(ymin,2),rep(ymax,2)),\n          col=rgb(0.5,0.5,0.5,0.5),border=NA)\n  abline(sub_lm,lty=2,lwd=1.5)\n  points(c(start:end),sub,pch=21,bg=\"white\")\n}\n\nshinyServer(function(input, output) {\n   \n  output$nomemPlot <- renderPlot({\n    ##Plots the no-memory time series.\n    plotfun(nomem_sim,input$window,input$nomem_center)\n  })\n\n  output$memPlot <- renderPlot({\n    ##Plots the no-memory time series.\n    plotfun(mem_sim,input$window,input$mem_center)\n  })\n  \n})\n",
    "created" : 1386364435905.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3929524405",
    "id" : "FCAF9D10",
    "lastKnownWriteTime" : 1386627308,
    "path" : "~/code/delta_c/autocorr_slope/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}